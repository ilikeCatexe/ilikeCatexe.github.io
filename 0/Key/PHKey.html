<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>PlangHub | Get Key</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
<script src="https://cdn.tailwindcss.com"></script>
<script>
    tailwind.config = {
    theme: {
        fontFamily: { sans: ['Prompt', 'sans-serif'] },
    },
    }
</script>
<style type="text/tailwindcss">
    @layer components { ::-webkit-scrollbar { display: none; } }
    @layer utilities {
    @keyframes heartbeat { 0%{transform:scale(1)} 50%{transform:scale(1.05)} 100%{transform:scale(1)} }
    }
</style>
</head>
<body class="bg-no-repeat bg-cover bg-center bg-fixed text-violet-50">
<section class="w-full h-screen backdrop-blur-none bg-black/30">
    <div class="flex flex-col h-screen justify-center items-center p-5">
    <div class="bg-violet-900/70 rounded-lg w-[95%] sm:w-[500px] max-h-[95%] p-5 shadow-lg shadow-violet-900/50 border-2 border-violet-900 overflow-y-auto">
        <h1 id="title" class="inline text-[#a89ac4]"></h1>

        <div class="hidden mt-4" data-hidden>
        <div id="key-area">
            <div class="grid grid-cols-2 gap-2 mt-3">
            <button
                id="copy-button"
                type="button"
                class="col-span-2 text-center text-lg w-full p-1.5 rounded-md bg-violet-500 select-none active:scale-95 transition-transform"
            >
                PlangHub Key:
                <br>
                <span id="key-text" class="block text-xs mt-1">******************</span>
            </button>
            <a class="text-center text-lg w-full p-1.5 rounded-md bg-[#5662f6] select-none active:scale-95 transition-transform block" href="https://discord.gg/zxNwa2bTRa" target="_blank" rel="noreferrer">Discord</a>
            <button id="copy-button" type="button" class="text-center text-lg w-full p-1.5 rounded-md bg-[#2374e1] select-none active:scale-95 transition-transform">
                Copy Key
            </button>
            </div>
        </div>
        </div>

        <p id="info" class="mt-3 text-xs text-gray-300">If you have problem with key system please try to contact support/owner in the discord server.</p>
    </div>
    </div>
</section>

<script>
    const bgImages = [
        'https://practicaltyping.com/wp-content/uploads/2023/03/bocchi-1.png',
        'https://cdn.discordapp.com/attachments/1178381908963496027/1430617706402676736/BocchiBG8K.png?ex=68fa6e10&is=68f91c90&hm=e2d9c487835ccb5d876ac135fadcd7e471e44a64221c0d7446efac3c1743d7f3',
        'https://cdn.discordapp.com/attachments/1178381908963496027/1430620673159598090/103922307_p0_master1200.jpg?ex=68fa70d4&is=68f91f54&hm=0ec9ceccae05b47801fb445af432340055b4273c75e3d32e3fe866adadd3a86e&',
        'https://cdn.discordapp.com/attachments/1178381908963496027/1430621452939558973/post-your-favourite-fanart-of-bocchi-the-rock-mine-is-this-v0-d0m0otocki1b12.jpg?ex=68fa718e&is=68f9200e&hm=a5398a7c247a14f4cf837e6f243d0de8c76717d9dbeef086315c9a50ee6f585e',
        'https://cdn.discordapp.com/attachments/1178381908963496027/1430620674363490396/post-your-favourite-fanart-of-bocchi-the-rock-mine-is-this-v0-tjmqfuaxdg1b1.jpg?ex=68fa70d4&is=68f91f54&hm=72dfe183a6264c88511c39a004049cd565ac756ff241228c3a9835701eb98cc3&'
    ];
    const chosenBg = bgImages[Math.floor(Math.random() * bgImages.length)];
    document.body.style.backgroundImage = `url('${chosenBg}')`;
</script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1"></script>
<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
<script src="https://cdn.jsdelivr.net/npm/tsparticles@2.5.3/tsparticles.bundle.min.js"></script>

<script>
    const CopyWarning = "Copy Done!";

    const params = new URLSearchParams(window.location.search);
    const tokenValue = (() => { // Insanly Cool Token Obfuscation
        const t = params.get('token');
        if (!t) return null;

        let seed = 0;
        for (let i = 0; i < t.length; i++) {
            seed = (seed << 5) - seed + t.charCodeAt(i);
            seed |= 0;
        }
        
        seed = Math.abs(seed); 

        const random = () => {
            seed = (seed * 9301 + 49297) % 233280;
            return seed / 233280;
        };

        const digitToGreek = {
            '0': ['α', 'ν'], '1': ['β', 'ξ'], '2': ['γ', 'ο'], '3': ['δ', 'π'], '4': ['ε', 'ρ'],
            '5': ['ζ', 'σ'], '6': ['η', 'τ'], '7': ['θ', 'υ'], '8': ['ι', 'φ'], '9': ['κ', 'χ']
        };

        const mathsym = ["∞", "≈", "≠", "≤", "≥", "√", "∑", "∏", "∆", "∇", "∂", "∫", "≡", "±", "÷", "×", "µ"];
        const greek = ["α", "β", "γ", "δ", "ε", "ζ", "η", "θ", "ι", "κ", "λ", "μ", "ν", "ξ", "ο", "π", "ρ", "σ", "τ", "υ", "φ", "χ", "ψ", "ω", "Α", "Β", "Γ", "Δ", "Ε", "Ζ", "Η", "Θ", "Ι", "Κ", "Λ", "Μ", "Ν", "Ξ", "Ο", "Π", "Ρ", "Σ", "Τ", "Υ", "Φ", "Χ", "Ψ", "Ω"];
        const numbers = "0123456789".split("");
        const alphabets = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
        
        const allChars = [...mathsym, ...greek, ...numbers, ...alphabets];

        const modifiedToken = t.replace(/[0-9]/g, (match) => {
            const options = digitToGreek[match];
            const randomIndex = Math.floor(random() * options.length); 
            return options[randomIndex] || match; 
        });

        let randomSuffix = "";
        for (let i = 0; i < 5; i++) {
            const randomIndex = Math.floor(random() * allChars.length);
            const char = allChars[randomIndex];
            randomSuffix += (char !== undefined ? char : allChars[Math.floor(Math.random() * allChars.length)]);
        }

        return `${modifiedToken}-${randomSuffix}`;
    })();


    function showKeyUI(token) {
        if(!token) return;
        $('#key-text').text(token);
        // Do NOT show key-area directly; let fadeIn handle it
        try {
        const safePath = window.location.pathname.split('/').slice(0,3).join('/') || '/';
        history.replaceState(null, '', safePath);
        } catch(e) {}
    }

    new Typed('#title', {
        strings: ['Welcome To <h2 class="inline text-xl text-white">Plang Hub</h2>,<br/>Happy Hacking~~'],
        typeSpeed: 25,
        startDelay: 300,
        loop: false,
        onComplete(self) {
        self.cursor.remove();
        if(tokenValue) showKeyUI(tokenValue);
        $('[data-hidden]').fadeIn('slow', function () {
            $(this).removeAttr('class')
            $(this).removeAttr('style')
            $(this).removeAttr('data-hidden')
        })
        }
    });

    $(function() {
        if(!tokenValue) $('#info').text('Error 400 - Missing token parameter. Please try get key again.');

        $('#display-button').on('click', function(e) {
            e.preventDefault();
            const el = $('#key-text');
            if(el.data('masked')) {
            el.text(tokenValue);
            el.data('masked', false);
            } else {
            const masked = tokenValue ? (tokenValue.slice(0,4) + '...' + tokenValue.slice(-4)) : '****************';
            el.text(masked);
            el.data('masked', true);
            }
        });

        $('#copy-button').on('click', async function(e) {
            e.preventDefault();
            if(!tokenValue) return alert('No token to copy');
            try {
            await navigator.clipboard.writeText(tokenValue);
            const el = $('#key-text');
            const prev = el.text();
            el.text(CopyWarning);
            setTimeout(() => el.text(prev), 1400);
            } catch(err) {
            alert('Failed to copy: ' + err);
            }
        });
    });

    tsParticles.load('tsparticles', {
    emitters: {
        direction: 'top',
        size: { width: 100, height: 0 },
        position: { x: 50, y: 100 },
        rate: { delay: 0.2, quantity: 1 },
    },
    particles: {
        number: { value: 0, density: { enable: true, value_area: 800 } },
        color: { value: '#ffffff' },
        opacity: { value: 1, anim: { enable: true, speed: 3, opacity_min: 0.1, sync: false } },
        size: { value: 1 },
        move: { enable: true, speed: 5, direction: 'none', random: false, straight: false, out_mode: 'destroy' },
    },
    });
</script>
</body>
</html>
